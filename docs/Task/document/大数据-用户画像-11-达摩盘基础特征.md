##### **基础特征包括年龄、性别、年代、身高、体重、星座 6 类标签**
#### 用户年龄标签
维度: 年龄: 18-24 岁、25-29 岁、30-34 岁、35-39 岁、40-49 岁、50 岁以上 -->join 数据, 使用 case end 做年龄段处理
先取 baseLine 的数据 user_info. Birthday, 加权计算 order_info. User_id = user_info. Id 订单表和用户表的关联关系
数据来源：淘宝平台用户行为日志数据（包括但不限于点击、浏览、搜索、收藏、加购、下单、支付、商品评价等）、商品类目属性数据
判断条件：      --固定数值
类目偏好（根据 order_detail 中的 suk 去关联 sku_info 关联base_category 1 品类表）
潮流服饰
家居用品
健康食品
品牌偏好 （sku_info关联 base_trademark 表进行分类）
ZARA
海澜之家
价格敏感度 （根据 order_info 中的 order_price 进行评判价格）
低价商品
中价商品
高价商品
时间行为 （根据数据的创建时间去进行评判时间断）
凌晨：00:00 - 05:59
早晨：06:00 - 08:59
上午：09:00 - 11:59
中午：12:00 - 13:59
下午：14:00 - 17:59
晚上：18:00 - 21:59
夜间：22:00 - 23:59
搜索词分析 （使用 ik 分词器对搜索词进行分词，得出搜索词）
时尚与潮流：“潮流”、“新款”、“时尚”等。
性价比：“优惠”、“折扣”、“便宜”等。
健康与养生：“健康食品”、“保健品”、“养生”等。
家庭与育儿：“婴儿用品”、“儿童玩具”、“亲子活动”等。
科技与数码：“智能手机”、“电脑配件”、“智能设备”等。
学习与发展：“在线课程”、“书籍”、“技能提升”等。
社交互动行为（通过 log 日志设计用户行为字段，进行评判）
参与直播：包括观看直播、与主播互动（点赞、评论）、购买直播推荐商品等。
发表评论：对商品或服务进行评价，分享使用体验。
分享商品：将感兴趣的商品分享给朋友或社交网络。
加入社区讨论：参与淘宝内的社区讨论，如圈子、话题讨论等。
关注达人/店铺：关注感兴趣的达人账号或店铺，获取最新动态
设备信息（log 日志表中的设备 id）
OS 设备：使用苹果公司的 iPhone 或 iPad 等设备。
Android 设备：使用基于 Android 系统的各种品牌手机或平板电脑。
桌面端（PC/Mac）：通过个人电脑或 Mac 访问淘宝。
最新系统版本：用户是否倾向于更新到操作系统的最新版本。
高端设备：指价格较高、配置较好的设备。
计算逻辑
直接计算：若用户有有效出生年份，直接计算年龄并归类。
行为加权判定：
若无出生年份，按以下步骤处理：
类目偏好：类目得分 = Σ（行为次数 × 类目对应年龄段的偏好系数）（如用户购买 3 次潮流服饰，则 18-24 岁得分：3 × 0.9 = 2.7）  
品牌偏好：逻辑同上，使用品牌偏好系数表。
价格敏感度：根据用户搜索词（如“折扣”“便宜”）频率加权。
时间行为：按时间段活跃频率分配得分（如凌晨活跃得 0.6 分）。
加权总分：
总分 = 类目偏好×30% + 品牌偏好×20% + 价格敏感度×15% + 时间行为×10% + 搜索词分析×10% + 社交互动×10% + 设备信息×5%  
最终判定：取最高分对应的年龄段。
更新频率：每日更新一次，基于用户最近 30 天的行为数据进行重新计算。
对于无新行为的用户，保留上一次标签结果
		
--------
#### 用户性别标签
维度：女性用户、男性用户、家庭用户。
分为两个 gender
1. 实际性别     --根据 user_info 中 gender 直接得出
2. 购买物品偏向性别  --根据计算逻辑算出
数据来源：
用户行为数据：
浏览、收藏、加购、购买的商品记录（一级品类）。
行为发生的时间戳（用于计算近 30 天/90 天活跃度）。
商品一级品类列表：   --添加一级品类表中字段
女性相关品类
男性相关品类
家庭相关品类
指标名称说明
女性得分用户在女性相关品类的行为加权得分（如购买女装、美容护肤）。
男性得分用户在男性相关品类的行为加权得分（如购买男装、运动装备）。
家庭用户判定家庭品类购买占比≥30%且性别得分差值≤10%。
计算逻辑
行为权重分配：
购买行为权重：50%（单次购买对性别判断影响最大）。
加购/收藏权重：30%。
浏览行为权重：20%。
得分计算：
女性得分 = Σ（购买次数×50% + 加购/收藏次数×30% + 浏览次数×20%）× 品类权重  
男性得分 = 同上逻辑，使用男性品类权重  
判定规则：
若女性得分 > 男性得分 + 10% → 女性用户。
若男性得分 > 女性得分 + 10% → 男性用户。
若家庭品类购买占比≥30%且得分差值≤10% → 家庭用户。
更新频率：
每日更新：基于用户最近 30 天的行为数据动态计算，确保标签反映最新行为趋势。对于无新行为的用户，保留上一次标签结果。
全量更新：每月对历史用户进行一次全量重新计算，修正长期行为偏差。

------
#### 用户体重标签
维度：无
数据来源：**暂无**
指标：
体重数值（单位：千克，保留 1 位小数）。
处理逻辑：
数据清洗：
单位统一：将“斤”转换为 kg（÷2），过滤非数值字符。
异常值过滤：剔除<30kg或>200 kg 的记录。
数据合并：
按优先级选择数据源，冲突时取权重最高的数据。
示例：若设备数据为 65 kg（权重 1.0），订单数据为 70 kg（权重 0.8），则最终取 65 kg。
标准化输出：四舍五入保留 1 位小数（如 64.4 kg→64.4，64.45 kg→64.5）。
更新频率：
T+1 日更新：每日凌晨拉取前一日增量数据，按规则覆盖历史值；
设备数据实时更新：若用户当日有设备同步记录，触发标签即时更新。
	
-----
#### 用户身高标签
维度：无
数据来源：**暂无**
指标：
身高数值（单位：厘米，整数）。
处理逻辑：
数据清洗：
过滤<100cm或>250 cm 的异常值，排除特殊数字（如 666、888）。
冲突处理：
若多源数据差异>5 cm，取最近 3 次有效记录的众数。
示例：设备数据 175 cm，购物数据 180 cm → 若差异>5 cm 且无众数，取最新数据。
补全规则：
服饰用户：根据尺码对照表推算（如男装 XL=180 cm）。
母婴用户：根据儿童年龄身高百分位表推算。
更新频率：
实时更新：智能硬件数据、新订单数据
T+1 更新：用户资料修改、客服记录
周级更新：尺码推算规则库
月级更新：年龄身高对照表
	
------
#### 出生年代标签
维度：出生年代（如 80 后、90 后、00 后）。
计算逻辑：
直接根据用户出生年份划分年代（如 1990 年出生→90 后）。
若无出生年份，跳过该标签（不进行行为推算）。
更新频率：
实时更新：用户主动修改生日后，触发实时计算更新星座标签
	
----
#### 星座标签
维度：十二星座（白羊座、金牛座等）。
计算逻辑：
提取用户填写的生日（月-日），按严格分界点匹配星座。
示例：3 月 21 日→白羊座，12 月 22 日→摩羯座。
若生日未填写，标记为“未知”。
更新频率：
实时更新：用户主动修改生日后，触发实时计算更新星座标签。
	
-----
数据架构设计
ADS 层表结构：
字段名类型说明
User_id	BIGINT	用户唯一标识
Age_range	STRING	年龄段标签
Gender	STRING	性别标签
Weight_kg	DECIMAL	体重（千克，1 位小数）
Height_cm	INT	身高（厘米）
Birth_decade	STRING	出生年代
Zodiac	STRING	星座
Update_time	TIMESTAMP	标签更新时间
数据源与采集
数据源类型：
Jar 包生成业务和日志数据，缺少字段进行补充模拟生成。
采集方式：
Flink CDC 读取 MySQL 数据变更，上传 Kafka。
使用 SeaTunnel 传输日志数据
数据清理：
去掉无关字段
关联 HBase 维度表，对数据进行处理获取指标
数据存储：
维度表写入 HBase
Redis：存储用户最新标签（Key: user:{user_id}, Field: age, gender 等），供广告系统实时查询
产出物：
Flink 作业代码
FineReport 报表展示
	